from telebot import types
from config import id_chat_owner
from db import log_user_action


class StartHandler:
    def __init__(self, bot):
        self.bot = bot

    def main_menu(self, message):
        """–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –¥–ª—è –∞–¥–º–∏–Ω–∞ –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    –í–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∏–ª–∏ –∫–ª–∏–µ–Ω—Ç)
    –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–Ω–æ–ø–∫–∏ –∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ."""
        markup = types.ReplyKeyboardMarkup(resize_keyboard=True)

        # –ü—Ä–æ–≤–µ—Ä–∫–∞, –∫—Ç–æ –æ—Ç–ø—Ä–∞–≤–∏–ª –∫–æ–º–∞–Ω–¥—É
        if str(message.chat.id) == id_chat_owner:
            # –ú–µ–Ω—é –¥–ª—è –∞–¥–º–∏–Ω–∞
            markup.row("üìù –ó–∞–ø–∏—Å–∞—Ç—å", "üìã –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∑–∞–ø–∏—Å–∏")
            markup.add("üë• –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π")
            welcome_text = (
                "üë®‚Äçüíº –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä!\n\n"
                "–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–Ω—É –∏–∑ –æ–ø—Ü–∏–π –Ω–∏–∂–µ, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å."
            )
        else:
            # –ú–µ–Ω—é –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            markup.row("‚ú® –í–∏–¥—ã –ø—Ä–æ—Ü–µ–¥—É—Ä", "üåê –î—Ä—É–≥–∏–µ —Å–æ—Ü —Å–µ—Ç–∏")
            markup.add("üìÖ –£–∑–Ω–∞—Ç—å –æ —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å–ª–æ—Ç–∞—Ö")
            welcome_text = (
                "üéâ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –Ø –≤–∞—à –ª–∏—á–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫. üëã\n\n"
                "–ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å –≤–∞–º —Å –∑–∞–ø–∏—Å—å—é –Ω–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–∞—à–∏—Ö —É—Å–ª—É–≥–∞—Ö! üòä\n\n"
                "–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–Ω—É –∏–∑ –æ–ø—Ü–∏–π –Ω–∏–∂–µ, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å:üëá"
            )

        # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        log_user_action(
            user_id=message.chat.id,
            username=message.from_user.username,
            action_type="start",
            action_details="main_menu"
        )

        # –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∫–Ω–æ–ø–∫–∞–º–∏
        self.bot.send_message(message.chat.id, welcome_text, reply_markup=markup)

    def show_main_menu_buttons(self, chat_id, message_id=None):
        """–û–±–Ω–æ–≤–ª—è–µ—Ç –∫–Ω–æ–ø–∫–∏ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é."""
        markup = types.ReplyKeyboardMarkup(resize_keyboard=True)

        if str(chat_id) == id_chat_owner:
            markup.add("üìù –ó–∞–ø–∏—Å–∞—Ç—å")
            markup.add("üìã –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∑–∞–ø–∏—Å–∏")
            markup.add("üë• –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π")
        else:
            markup.row("‚ú® –í–∏–¥—ã –ø—Ä–æ—Ü–µ–¥—É—Ä", "üåê –î—Ä—É–≥–∏–µ —Å–æ—Ü —Å–µ—Ç–∏")
            markup.add("üìÖ –£–∑–Ω–∞—Ç—å –æ —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å–ª–æ—Ç–∞—Ö")
            markup.add("üôè –°–ø–∞—Å–∏–±–æ, –≤–µ—Ä–Ω—É—Ç—å—Å—è –ø–æ–∑–∂–µ")  # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é –∫–Ω–æ–ø–∫—É

        if message_id:
            # –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É, –µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω message_id
            self.bot.edit_message_reply_markup(chat_id, message_id, reply_markup=markup)
        else:
            # –ï—Å–ª–∏ –Ω–µ—Ç message_id, –ø—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π
            self.bot.send_message(chat_id, "üëá –í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –∏–∑ –º–µ–Ω—é:", reply_markup=markup)

    def show_start_button(self, chat_id):
        """–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∫–Ω–æ–ø–∫—É '–ó–∞–ø—É—Å—Ç–∏—Ç—å' –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –±–æ—Ç–æ–º.
            –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –µ—Å–ª–∏ –º–µ–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±—ã–ª–æ —Ä–∞–Ω–µ–µ —Å–∫—Ä—ã—Ç–æ –∏–ª–∏ —É–¥–∞–ª–µ–Ω–æ."""
        markup = types.ReplyKeyboardMarkup(resize_keyboard=True, one_time_keyboard=True)
        markup.add("üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å")
        self.bot.send_message(chat_id, "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –ù–∞–∂–º–∏—Ç–µ '–ó–∞–ø—É—Å—Ç–∏—Ç—å', —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å. üöÄ", reply_markup=markup)


